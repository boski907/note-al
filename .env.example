OPENAI_API_KEY=your_api_key_here
OPENAI_MODEL=gpt-4.1-mini
OPENAI_TRANSCRIBE_MODEL=gpt-4o-mini-transcribe
HOST=127.0.0.1
PORT=3000

# Supabase runtime (required for production mode)
SUPABASE_URL=
SUPABASE_ANON_KEY=

# Optional: only needed for admin scripts/migrations outside this app runtime
SUPABASE_SERVICE_ROLE_KEY=

# AdSense (public website)
# Example: ADSENSE_CLIENT=ca-pub-1234567890
# Keep OFF until your site is approved by AdSense.
ADS_ENABLED=0
ADSENSE_CLIENT=
ADSENSE_SLOT_BOTTOM=
ADSENSE_SLOT_BREAK=

# Stripe (ad-free subscription)
APP_BASE_URL=http://127.0.0.1:3000
STRIPE_SECRET_KEY=
# Create a recurring monthly price for $10.00 and put its price id here (e.g. price_123)
STRIPE_PRICE_ID_PREMIUM_10=
# Backward-compatible legacy variable name
STRIPE_PRICE_ID_ADFREE_599=
# From Stripe webhook endpoint config
STRIPE_WEBHOOK_SECRET=

# Owner-only features (comma-separated emails). Only owners can access Builder chat.
OWNER_EMAILS=lboski@live.com

# Security / abuse protection (recommended)
# Enable in production (Render). Local default is off.
RATE_LIMIT_ENABLED=1
# Shared/distributed limiter via Supabase RPC (recommended in production).
# Requires migration: 202602201005_create_security_rate_limits.sql
RATE_LIMIT_SHARED=1
# Enforce same-origin/cors-allowlisted origins for cookie-auth state-changing API requests.
CSRF_ORIGIN_CHECK_ENABLED=1

# Body size limits (bytes)
MAX_BODY_BYTES=12000000
TRANSCRIBE_MAX_BODY_BYTES=20000000
STRIPE_WEBHOOK_MAX_BODY_BYTES=2000000

# Rate limiting
RL_AUTH_WINDOW_MS=600000
RL_AUTH_LOGIN_MAX=20
RL_AUTH_REGISTER_MAX=10

RL_AI_WINDOW_MS=60000
RL_AI_MAX_PER_IP=30
RL_AI_MAX_PER_USER=60

# Security monitoring + alerting pipeline
SECURITY_MONITORING_ENABLED=1
SECURITY_EVENT_RETENTION_DAYS=14
SECURITY_ALERT_RETENTION_DAYS=30
SECURITY_EVENT_MAX_ITEMS=20000
SECURITY_ALERT_MAX_ITEMS=5000
SECURITY_ALERT_COOLDOWN_MS=900000
SECURITY_ALERT_CONSOLE_ENABLED=1
# Optional webhook for security alerts (Slack/Discord/custom incident endpoint)
SECURITY_ALERT_WEBHOOK_URL=
SECURITY_ALERT_WEBHOOK_TIMEOUT_MS=5000
# auto | slack | discord | json
SECURITY_ALERT_WEBHOOK_FORMAT=auto
# Optional for custom endpoints that require bearer auth
SECURITY_ALERT_WEBHOOK_BEARER_TOKEN=

# Optional anomaly thresholds (tune once you observe real traffic)
SEC_ALERT_LOGIN_FAIL_IP_THRESHOLD=8
SEC_ALERT_LOGIN_FAIL_IP_WINDOW_MS=600000
SEC_ALERT_LOGIN_FAIL_EMAIL_THRESHOLD=6
SEC_ALERT_LOGIN_FAIL_EMAIL_WINDOW_MS=600000
SEC_ALERT_UNAUTHORIZED_IP_THRESHOLD=20
SEC_ALERT_UNAUTHORIZED_IP_WINDOW_MS=300000
SEC_ALERT_RATE_LIMIT_THRESHOLD=25
SEC_ALERT_RATE_LIMIT_WINDOW_MS=300000
SEC_ALERT_BLOCKED_IMPORT_THRESHOLD=3
SEC_ALERT_BLOCKED_IMPORT_WINDOW_MS=1800000
SEC_ALERT_STRIPE_WEBHOOK_THRESHOLD=3
SEC_ALERT_STRIPE_WEBHOOK_WINDOW_MS=1800000
SEC_ALERT_5XX_THRESHOLD=8
SEC_ALERT_5XX_WINDOW_MS=300000

# Quota-style per-user limits (requires Supabase migration 202602171400_create_usage_counters.sql)
USAGE_LIMITS_ENABLED=1
FREE_DAILY_AI_OUTPUT_LIMIT=60
PREMIUM_DAILY_AI_OUTPUT_LIMIT=500
FREE_DAILY_FLASHCARD_GEN_LIMIT=20
PREMIUM_DAILY_FLASHCARD_GEN_LIMIT=200
FREE_DAILY_SOURCE_IMPORT_LIMIT=20
PREMIUM_DAILY_SOURCE_IMPORT_LIMIT=200
FREE_DAILY_TRANSCRIBE_LIMIT=10
PREMIUM_DAILY_TRANSCRIBE_LIMIT=200

# CORS (needed for the native mobile wrapper when it loads local assets and calls the live API)
# Comma-separated list of allowed origins. (capacitor://localhost and your domain are allowed by default.)
# CORS_ALLOW_ORIGINS=
