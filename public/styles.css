/* ================================================================
   Notematica — Scholar Design System v2.0
   Palette: Parchment × Amethyst × Sienna
   Typography: Fraunces (display) · DM Sans (body) · JetBrains Mono (code)
   ================================================================ */

@import url("https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;0,800;1,400&family=JetBrains+Mono:wght@400;600;700&family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700;9..144,800&display=swap");

/* ────────────────────────────────────────────────────────────────
   1. Design Tokens
   ──────────────────────────────────────────────────────────────── */
:root {
  /* — Parchment palette — */
  --bg:             #f0ebe0;
  --bg-b:           #e8e2d6;
  --surface:        #faf7f2;
  --card:           rgba(255, 254, 250, 0.93);
  --card-solid:     #fffefa;

  /* — Ink — */
  --text:           #1a1512;
  --muted:          #7a7068;
  --line:           #ddd6cb;
  --line-strong:    #cac2b7;

  /* — Amethyst (primary) — */
  --accent:         #5b21b6;
  --accent-mid:     #6d28d9;
  --accent-soft:    #ede9fe;
  --accent-hover:   #4c1d95;

  /* — Sienna (secondary) — */
  --accent-2:       #a84f0a;
  --accent-2-soft:  #fff7ed;

  /* — Semantic — */
  --danger:         #b91c1c;
  --danger-soft:    #fee2e2;
  --success:        #166534;

  /* — Elevation — */
  --shadow:         0 6px 24px rgba(26, 21, 18, 0.07);
  --shadow-strong:  0 18px 52px rgba(26, 21, 18, 0.14);
  --shadow-card:    0 2px 12px rgba(26, 21, 18, 0.06);
  --ring:           rgba(91, 33, 182, 0.26);

  /* — Radius — */
  --r-sm:   8px;
  --r-md:   12px;
  --r-lg:   16px;
  --r-xl:   22px;
  --r-pill: 999px;

  /* — Motion — */
  --ease-out:    cubic-bezier(0.16, 1, 0.3, 1);
  --ease-spring: cubic-bezier(0.34, 1.56, 0.64, 1);
  --dur-fast:    120ms;
  --dur-base:    200ms;
  --dur-slow:    360ms;

  /* — Ads — */
  --bottom-ad-height: 0px;
}

body[data-theme="clean"] {
  --bg:          #f7f4ef;
  --bg-b:        #efebe4;
  --surface:     #fdfcf9;
  --card:        rgba(255, 255, 255, 0.96);
  --card-solid:  #ffffff;
  --muted:       #72695f;
  --line:        #e0d9d0;
  --line-strong: #d0c8be;
  --shadow:      0 4px 18px rgba(26, 21, 18, 0.05);
  --shadow-strong: 0 14px 40px rgba(26, 21, 18, 0.11);
}

/* ────────────────────────────────────────────────────────────────
   2. Reset & Base
   ──────────────────────────────────────────────────────────────── */
*, *::before, *::after {
  box-sizing: border-box;
}

html, body {
  min-height: 100%;
}

body {
  margin: 0;
  font-family: "DM Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  font-size: 15px;
  line-height: 1.6;
  color: var(--text);
  background-color: var(--bg);
  overflow-x: hidden;
  padding-bottom: calc(18px + var(--bottom-ad-height, 0px));
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body,
button,
input,
select,
textarea {
  font-family: "DM Sans", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

/* ────────────────────────────────────────────────────────────────
   3. Background System
   ──────────────────────────────────────────────────────────────── */
body {
  background-image:
    radial-gradient(ellipse 1100px 700px at -4% -8%,  rgba(91, 33, 182, 0.18) 0%, transparent 68%),
    radial-gradient(ellipse 800px  550px at 104% -6%, rgba(180, 83,  9,  0.13) 0%, transparent 65%),
    radial-gradient(ellipse 600px  500px at 50%  108%,rgba(91, 33, 182, 0.10) 0%, transparent 65%),
    linear-gradient(168deg, #f5f0e6 0%, #ede7db 48%, #e9e2d6 100%);
}

body[data-theme="clean"] {
  background-image:
    radial-gradient(ellipse 1100px 700px at -4% -8%,  rgba(91, 33, 182, 0.12) 0%, transparent 68%),
    radial-gradient(ellipse 800px  550px at 104% -6%, rgba(180, 83,  9,  0.09) 0%, transparent 65%),
    radial-gradient(ellipse 600px  500px at 50%  108%,rgba(91, 33, 182, 0.07) 0%, transparent 65%),
    linear-gradient(168deg, #f9f5ef 0%, #f3ede5 48%, #f0e9e1 100%);
}

/* Dot-grid backdrop */
.backdrop {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background-image:
    radial-gradient(circle, rgba(91, 33, 182, 0.10) 1px, transparent 1px);
  background-size: 28px 28px;
  mask-image: radial-gradient(ellipse 90% 90% at 50% 50%, black 20%, transparent 80%);
}

/* ────────────────────────────────────────────────────────────────
   4. App Shell (index.html two-zone grid)
   ──────────────────────────────────────────────────────────────── */
.app-shell {
  position: relative;
  z-index: 2;
  width: min(1480px, calc(100vw - 18px));
  margin: 9px auto;
  min-height: calc(100vh - 18px);
  border: 1px solid rgba(180, 155, 120, 0.28);
  border-radius: var(--r-xl);
  background:
    linear-gradient(148deg, rgba(255, 255, 255, 0.65) 0%, rgba(255, 252, 247, 0.44) 100%),
    var(--surface);
  box-shadow:
    var(--shadow-strong),
    inset 0 1px 0 rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(14px);
  overflow: hidden;
  display: grid;
  grid-template-columns: 248px minmax(0, 1fr);
}

/* ────────────────────────────────────────────────────────────────
   5. Left Rail — Study Navigator
   ──────────────────────────────────────────────────────────────── */
.left-rail {
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 18px;
  padding: 20px 14px 16px;
  background:
    linear-gradient(180deg, rgba(250, 247, 241, 0.98) 0%, rgba(244, 239, 231, 0.95) 100%),
    radial-gradient(circle at 10% 0%, rgba(91, 33, 182, 0.09) 0%, transparent 55%);
  border-right: 1px solid var(--line);
}

.rail-brand {
  display: grid;
  align-content: start;
  gap: 6px;
}

.rail-brand-link {
  display: inline-flex;
  align-items: center;
}

.rail-brand-logo {
  width: min(186px, 100%);
  height: auto;
  display: block;
}

.rail-kicker {
  margin: 0;
  font: 600 0.68rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--accent);
  opacity: 0.75;
  padding-left: 2px;
}

.rail-nav {
  display: grid;
  gap: 5px;
  align-content: start;
}

.rail-nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  border: 1px solid transparent;
  border-radius: var(--r-lg);
  background: transparent;
  color: #4a4038;
  padding: 10px 12px;
  font: 600 0.88rem/1.2 "DM Sans", sans-serif;
  cursor: pointer;
  transition:
    background var(--dur-base) var(--ease-out),
    border-color var(--dur-base) var(--ease-out),
    color var(--dur-base) var(--ease-out);
  justify-content: flex-start;
  text-align: left;
}

.rail-nav-glyph {
  flex-shrink: 0;
  width: 30px;
  height: 30px;
  border-radius: var(--r-sm);
  border: 1px solid var(--line-strong);
  display: grid;
  place-items: center;
  background: rgba(255, 255, 255, 0.82);
  font: 600 0.64rem/1 "JetBrains Mono", monospace;
  color: var(--muted);
  letter-spacing: 0.05em;
  transition: inherit;
}

.rail-nav-item:hover,
.rail-nav-item.active {
  background: linear-gradient(135deg, rgba(237, 233, 254, 0.92) 0%, rgba(246, 242, 255, 0.78) 100%);
  border-color: rgba(91, 33, 182, 0.28);
  color: var(--accent-hover);
}

.rail-nav-item:hover .rail-nav-glyph,
.rail-nav-item.active .rail-nav-glyph {
  border-color: rgba(91, 33, 182, 0.36);
  background: var(--accent-soft);
  color: var(--accent);
}

.rail-bottom {
  padding-top: 12px;
  border-top: 1px solid var(--line);
}

.rail-profile-btn {
  width: 100%;
}

/* ────────────────────────────────────────────────────────────────
   6. Main Pane & Top Bar
   ──────────────────────────────────────────────────────────────── */
.main-pane {
  display: grid;
  grid-template-rows: auto minmax(0, 1fr);
  min-width: 0;
  background: linear-gradient(180deg, rgba(252, 249, 244, 0.80) 0%, rgba(249, 245, 238, 0.65) 100%);
}

.top-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 13px 18px;
  border-bottom: 1px solid var(--line);
  background: rgba(253, 250, 245, 0.94);
  backdrop-filter: blur(12px);
}

.top-head {
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 0;
}

.top-brand-link {
  display: inline-flex;
  align-items: center;
  flex-shrink: 0;
}

.top-brand-logo {
  width: 140px;
  height: auto;
  display: block;
}

.top-head-copy {
  display: grid;
  gap: 1px;
}

.top-kicker {
  font: 600 0.65rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--accent);
  opacity: 0.8;
}

.top-title {
  font: 600 0.9rem/1.3 "DM Sans", sans-serif;
  color: #3a2e25;
  letter-spacing: 0.01em;
}

.top-actions {
  align-items: center;
  justify-content: flex-end;
}

/* ────────────────────────────────────────────────────────────────
   7. Route Canvas & Views
   ──────────────────────────────────────────────────────────────── */
.route-canvas {
  min-height: 0;
  overflow: auto;
  padding: 16px;
}

.route-view {
  min-height: calc(100vh - 115px);
}

.route-view.hidden {
  display: none;
}

/* ────────────────────────────────────────────────────────────────
   8. Home View
   ──────────────────────────────────────────────────────────────── */
.home-stage {
  display: grid;
  gap: 14px;
  animation: fadeUp var(--dur-slow) var(--ease-out) both;
}

.home-orbit-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.62fr) minmax(290px, 1fr);
  gap: 14px;
}

/* Command card */
.home-command {
  display: grid;
  gap: 12px;
  position: relative;
  overflow: hidden;
}

.home-command::before {
  content: "";
  position: absolute;
  inset: auto -8% -38% auto;
  width: 52%;
  height: 72%;
  border-radius: var(--r-pill);
  background: radial-gradient(circle at center, rgba(91, 33, 182, 0.10), transparent);
  pointer-events: none;
}

.home-command-head {
  position: relative;
  z-index: 1;
}

.home-label {
  display: inline-flex;
  align-items: center;
  border-radius: var(--r-pill);
  border: 1px solid rgba(91, 33, 182, 0.30);
  background: var(--accent-soft);
  padding: 4px 11px;
  font: 600 0.65rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
}

.home-title {
  margin: 9px 0 0;
  font: 700 1.95rem/1.18 "Fraunces", "DM Sans", sans-serif;
  color: #1a1209;
  letter-spacing: 0.01em;
}

#home-welcome-message {
  margin: 0;
  font-size: 0.97rem;
  color: var(--muted);
}

/* Study composer */
.home-composer {
  width: 100%;
  margin: 0;
  padding: 12px;
  border-radius: var(--r-lg);
  border: 1px solid rgba(91, 33, 182, 0.22);
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.88), rgba(246, 243, 255, 0.65));
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 10px;
  box-shadow: var(--shadow-card), inset 0 1px 0 rgba(255, 255, 255, 0.6);
  position: relative;
  z-index: 1;
}

.home-composer-input {
  width: 100%;
  border: 0;
  background: transparent;
  padding: 8px;
  font: 500 0.97rem "DM Sans", sans-serif;
  color: var(--text);
}

.home-composer-input:focus {
  outline: none;
}

.home-composer-input::placeholder {
  color: var(--muted);
  opacity: 0.75;
}

.home-composer-actions {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 7px;
}

/* Chips */
.home-chip-row {
  display: flex;
  gap: 7px;
  flex-wrap: wrap;
  margin-top: 2px;
  position: relative;
  z-index: 1;
  justify-content: flex-start;
}

.home-chip {
  border-radius: var(--r-pill) !important;
  border-color: var(--line-strong) !important;
  background: rgba(255, 255, 255, 0.78) !important;
  color: #4a3e32 !important;
  font-size: 0.82rem !important;
  padding: 6px 12px !important;
  transition: background var(--dur-fast) ease, border-color var(--dur-fast) ease !important;
}

.home-chip:hover {
  background: var(--accent-soft) !important;
  border-color: rgba(91, 33, 182, 0.34) !important;
  color: var(--accent) !important;
}

/* Quick-launch card */
.home-sprint {
  display: grid;
  align-content: start;
  gap: 10px;
}

.home-sprint h3 {
  margin: 0;
  font: 700 1.08rem/1.2 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
}

.home-action-stack {
  display: grid;
  gap: 8px;
}

.home-action-stack button {
  width: 100%;
  justify-content: center;
}

.home-sprint-meta {
  display: grid;
  gap: 6px;
  padding-top: 10px;
  border-top: 1px solid var(--line);
}

/* Metrics */
.home-outcomes {
  margin-top: 0;
}

.home-outcomes-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 12px;
}

.home-outcomes-head h3 {
  margin: 0;
  font: 700 1.1rem "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
}

.home-metrics-grid {
  grid-template-columns: repeat(6, minmax(0, 1fr));
}

.home-upgrade {
  margin-top: 10px;
  border: 1px solid rgba(91, 33, 182, 0.24);
  border-radius: var(--r-md);
  background: linear-gradient(135deg, rgba(237, 233, 254, 0.88), rgba(245, 243, 255, 0.75));
  padding: 12px;
}

.home-upgrade-message {
  margin-bottom: 10px;
  color: var(--accent-hover);
  font-size: 0.88rem;
  font-weight: 600;
}

/* Momentum feed */
.home-feed {
  margin-top: 0;
}

.home-feed-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
  margin-bottom: 12px;
}

.home-feed-head h3 {
  margin: 0;
  font: 700 1.1rem "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
}

.home-feed-actions {
  justify-content: flex-end;
}

.learning-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
}

/* Learning cards (JS-generated) */
.learning-card {
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  overflow: hidden;
  background: var(--card);
  cursor: pointer;
  transition:
    transform var(--dur-base) var(--ease-out),
    box-shadow var(--dur-base) var(--ease-out),
    border-color var(--dur-base) ease;
}

.learning-card:hover {
  transform: translateY(-3px);
  border-color: rgba(91, 33, 182, 0.36);
  box-shadow: 0 12px 28px rgba(26, 21, 18, 0.13);
}

.learning-card-thumb {
  min-height: 116px;
  position: relative;
  overflow: hidden;
  background: linear-gradient(135deg, #c4b5fd, #a78bfa);
}

.learning-card-thumb-image {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.learning-card-index {
  position: absolute;
  left: 10px;
  top: 10px;
  z-index: 2;
  border-radius: var(--r-pill);
  border: 1px solid rgba(255, 255, 255, 0.45);
  background: rgba(26, 21, 18, 0.38);
  color: #fff;
  font: 600 0.64rem/1 "JetBrains Mono", monospace;
  padding: 4px 8px;
  letter-spacing: 0.08em;
}

.learning-card-body {
  padding: 11px;
  display: grid;
  gap: 5px;
}

.learning-card-title {
  margin: 0;
  font: 600 0.93rem/1.32 "DM Sans", sans-serif;
  color: var(--text);
}

.learning-card-meta {
  margin: 0;
  font-size: 0.78rem;
  color: var(--muted);
}

.learning-card-topic {
  display: inline-flex;
  width: fit-content;
  border-radius: var(--r-pill);
  border: 1px solid rgba(91, 33, 182, 0.28);
  background: var(--accent-soft);
  padding: 3px 9px;
  font: 600 0.67rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.07em;
  text-transform: uppercase;
  color: var(--accent);
}

.learning-empty {
  grid-column: 1 / -1;
  border: 1px dashed var(--line-strong);
  border-radius: var(--r-lg);
  background: rgba(250, 247, 241, 0.7);
  padding: 18px;
  display: grid;
  gap: 8px;
}

.learning-empty h4 {
  margin: 0;
  color: var(--text);
  font-size: 1rem;
}

.learning-empty p {
  margin: 0;
  color: var(--muted);
  font-size: 0.9rem;
}

.learning-empty .learning-empty-reset-btn {
  width: fit-content;
}

/* ────────────────────────────────────────────────────────────────
   9. View Hero (Notebook / Study Lab / Sources / Account)
   ──────────────────────────────────────────────────────────────── */
#view-notes.notebook-view,
#view-study-tools.study-lab-view,
#view-sources.sources-view,
#view-account.account-view {
  display: grid;
  gap: 14px;
}

.view-hero {
  border: 1px solid var(--line);
  border-radius: var(--r-xl);
  padding: 18px 20px;
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  gap: 14px;
  align-items: center;
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}

.view-hero::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(145deg, rgba(255, 255, 255, 0.82) 0%, rgba(249, 244, 235, 0.55) 100%);
  pointer-events: none;
}

.view-hero-copy {
  position: relative;
  z-index: 1;
}

.view-hero-kicker {
  display: inline-flex;
  align-items: center;
  width: fit-content;
  border-radius: var(--r-pill);
  border: 1px solid rgba(91, 33, 182, 0.30);
  background: var(--accent-soft);
  padding: 4px 10px;
  font: 600 0.66rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--accent);
}

.view-hero-copy h2 {
  margin: 10px 0 6px;
  font: 700 1.55rem/1.22 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
  letter-spacing: 0.01em;
}

.view-hero-copy p {
  margin: 0;
  color: var(--muted);
  font-size: 0.95rem;
  max-width: 64ch;
}

.view-hero-pills {
  display: flex;
  flex-wrap: wrap;
  gap: 7px;
  justify-content: flex-end;
  position: relative;
  z-index: 1;
}

.view-pill {
  border-radius: var(--r-pill);
  border: 1px solid var(--line-strong);
  background: rgba(255, 255, 255, 0.80);
  padding: 7px 12px;
  font: 600 0.72rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: #4a3e32;
}

/* Hero accent colours */
.notebook-hero {
  background:
    radial-gradient(circle at 88% 22%, rgba(91, 33, 182, 0.12), transparent 55%),
    var(--surface);
}

.study-lab-hero {
  background:
    radial-gradient(circle at 88% 22%, rgba(180, 83, 9, 0.11), transparent 55%),
    var(--surface);
}

.sources-hero {
  background:
    radial-gradient(circle at 88% 22%, rgba(91, 33, 182, 0.10), transparent 55%),
    var(--surface);
}

.account-hero {
  background:
    radial-gradient(circle at 88% 22%, rgba(180, 83, 9, 0.09), transparent 55%),
    var(--surface);
}

/* ────────────────────────────────────────────────────────────────
   10. Notebook Workspace
   ──────────────────────────────────────────────────────────────── */
.workspace {
  display: grid;
  grid-template-columns: 310px minmax(0, 1fr);
  gap: 14px;
  min-height: calc(100vh - 280px);
}

.notebook-workspace {
  grid-template-columns: 310px minmax(0, 1fr);
  gap: 14px;
}

.panel {
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  overflow: hidden;
  box-shadow: var(--shadow);
}

.panel.left,
.panel.right {
  display: flex;
  flex-direction: column;
}

.left-header,
.editor-header {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 14px;
  border-bottom: 1px solid var(--line);
  background: rgba(253, 250, 245, 0.92);
}

.left-header {
  justify-content: space-between;
}

.editor-header {
  flex-wrap: wrap;
}

.search-wrap {
  padding: 10px 12px;
  border-bottom: 1px solid var(--line);
  background: rgba(250, 247, 241, 0.65);
}

.notes-list {
  overflow: auto;
  padding: 10px;
  display: grid;
  gap: 7px;
}

.note-item {
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background: rgba(255, 254, 250, 0.88);
  padding: 10px;
  cursor: pointer;
  transition:
    transform var(--dur-fast) var(--ease-out),
    border-color var(--dur-fast) ease,
    box-shadow var(--dur-fast) ease;
  margin-bottom: 0;
}

.note-item:hover {
  transform: translateY(-2px);
  border-color: rgba(91, 33, 182, 0.36);
  box-shadow: 0 6px 18px rgba(26, 21, 18, 0.08);
}

.note-item.active {
  border-color: var(--accent);
  background: linear-gradient(145deg, var(--accent-soft), rgba(246, 243, 255, 0.88));
  box-shadow: inset 0 0 0 1px rgba(91, 33, 182, 0.30), 0 4px 12px rgba(91, 33, 182, 0.10);
}

.note-title {
  font: 600 0.94rem/1.3 "DM Sans", sans-serif;
  color: var(--text);
  margin-bottom: 4px;
}

.note-meta,
.note-tags {
  font-size: 0.76rem;
  color: var(--muted);
}

.tab-bar {
  display: flex;
  align-items: center;
  gap: 7px;
  padding: 10px 12px;
  border-bottom: 1px solid var(--line);
  background: rgba(252, 249, 243, 0.90);
}

.tab-bar .tab {
  border-radius: var(--r-pill);
  border: 1px solid var(--line-strong);
  background: rgba(255, 255, 255, 0.78);
  color: var(--muted);
  font: 600 0.84rem "DM Sans", sans-serif;
  padding: 6px 13px;
  box-shadow: none;
}

.tab-bar .tab.active {
  background: var(--accent-soft);
  border-color: rgba(91, 33, 182, 0.36);
  color: var(--accent-hover);
}

.output-dock {
  margin: 12px;
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  overflow: hidden;
  background: var(--card-solid);
}

.dock-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 9px 12px;
  border-bottom: 1px solid var(--line);
  background: linear-gradient(90deg,
    rgba(237, 233, 254, 0.8),
    rgba(255, 247, 237, 0.7));
}

.output-dock .ai-output {
  margin: 0;
  border: 0;
  border-radius: 0;
  min-height: 88px;
  max-height: 240px;
}

.tab-panel {
  padding: 13px;
  display: grid;
  gap: 10px;
}

.tab-panel.hidden {
  display: none;
}

.toolbar {
  padding: 0;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--line);
}

.note-editor {
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background:
    repeating-linear-gradient(
      180deg,
      rgba(91, 33, 182, 0.04) 0px,
      rgba(91, 33, 182, 0.04) 1px,
      transparent 1px,
      transparent 29px
    ),
    linear-gradient(180deg, #fffefa, #faf7f0);
  min-height: 44vh;
  padding: 13px;
  overflow: auto;
  font: 400 0.93rem/1.58 "JetBrains Mono", monospace;
  white-space: pre-wrap;
  color: var(--text);
}

.note-editor:focus {
  outline: 2px solid var(--ring);
  outline-offset: 1px;
}

.note-editor .transcript-entry {
  border-left: 3px solid rgba(91, 33, 182, 0.38);
  padding-left: 10px;
}

.ai-tools {
  border-top: 1px solid var(--line);
  padding-top: 10px;
}

/* ────────────────────────────────────────────────────────────────
   11. Study Lab Layout
   ──────────────────────────────────────────────────────────────── */
#view-study-tools .study-lab-stack {
  max-width: none;
  display: grid;
  grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
  grid-template-areas:
    "hub  hub"
    "tutor plan"
    "learning learning";
  gap: 14px;
}

#view-study-tools .study-card {
  position: relative;
  overflow: hidden;
}

#view-study-tools .study-card::before {
  content: "";
  position: absolute;
  left: 0; right: 0; top: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent), rgba(91, 33, 182, 0.5), var(--accent-2));
}

#view-study-tools .study-hub-card    { grid-area: hub; }
#view-study-tools .study-tutor-card  { grid-area: tutor; }
#view-study-tools .study-plan-card   { grid-area: plan; }
#view-study-tools .study-learning-card { grid-area: learning; }

#view-study-tools #tutor-output {
  min-height: 180px;
}

#view-study-tools .metrics-grid.two-col {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

/* ────────────────────────────────────────────────────────────────
   12. Sources Stack
   ──────────────────────────────────────────────────────────────── */
.sources-stack {
  max-width: none;
  display: grid;
  grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
  grid-template-areas: "import list";
  gap: 14px;
}

.source-import-card { grid-area: import; }
.source-list-card   { grid-area: list; }

.sources-list {
  display: grid;
  gap: 8px;
  margin-top: 10px;
}

.source-item {
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background: var(--card-solid);
  padding: 10px;
  display: grid;
  gap: 7px;
}

.source-item-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.source-item-title {
  font: 600 0.9rem "DM Sans", sans-serif;
  overflow-wrap: anywhere;
}

.source-item-meta {
  font: 600 0.76rem "JetBrains Mono", monospace;
  color: var(--muted);
}

.source-item-snippet {
  font-size: 0.85rem;
  color: var(--text);
  overflow-wrap: anywhere;
}

/* ────────────────────────────────────────────────────────────────
   13. Account / Profile View
   ──────────────────────────────────────────────────────────────── */
.account-stack {
  max-width: 920px;
}

.account-stack-modern {
  max-width: none;
}

.account-card {
  /* uses .card-face styles */
}

.account-profile-wrap {
  display: grid;
  grid-template-columns: 170px minmax(0, 1fr);
  gap: 12px;
  margin-bottom: 10px;
}

.account-avatar-wrap {
  display: grid;
  gap: 8px;
  align-content: start;
}

.account-avatar-preview {
  width: 124px;
  height: 124px;
  border-radius: 50%;
  border: 2px solid var(--line-strong);
  background: rgba(255, 254, 250, 0.9);
  object-fit: cover;
}

.account-profile-fields {
  display: grid;
  gap: 7px;
}

.field-label {
  font: 600 0.76rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--muted);
}

.danger-zone-card {
  border-color: rgba(185, 28, 28, 0.22);
  background: linear-gradient(160deg, rgba(255, 248, 248, 0.92), rgba(255, 254, 250, 0.9));
}

.account-advanced summary {
  cursor: pointer;
  font-weight: 700;
}

.advanced-body {
  margin-top: 10px;
  display: grid;
  gap: 8px;
}

/* ────────────────────────────────────────────────────────────────
   14. Shared Cards & Metrics
   ──────────────────────────────────────────────────────────────── */
.card-face {
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  background: var(--card);
  padding: 16px;
  box-shadow: var(--shadow-card);
  backdrop-filter: blur(8px);
}

.card-face h3 {
  margin: 0 0 8px;
  font: 700 1.05rem/1.25 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
}

.view-stack {
  display: grid;
  gap: 14px;
}

.metrics-grid {
  display: grid;
  gap: 10px;
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

.metrics-grid.two-col {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

.metric-card {
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background: linear-gradient(145deg, rgba(255, 254, 250, 0.95), rgba(248, 244, 236, 0.80));
  padding: 10px 12px;
  transition: transform var(--dur-fast) var(--ease-out), box-shadow var(--dur-fast) ease;
}

.metric-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(26, 21, 18, 0.09);
}

.metric-label {
  font: 600 0.68rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--muted);
}

.metric-value {
  margin-top: 5px;
  font: 700 1rem/1 "JetBrains Mono", monospace;
  color: var(--accent-hover);
  overflow-wrap: anywhere;
}

/* ────────────────────────────────────────────────────────────────
   15. Overlays & Modals
   ──────────────────────────────────────────────────────────────── */
.overlay {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  padding: 12px;
  z-index: 110;
  background: linear-gradient(160deg, rgba(26, 21, 18, 0.64), rgba(26, 21, 18, 0.52));
  backdrop-filter: blur(3px);
}

.overlay.hidden {
  display: none;
}

.overlay-card {
  width: min(920px, 100%);
  max-height: min(88vh, 900px);
  overflow: hidden;
  border-radius: var(--r-xl);
  border: 1px solid var(--line);
  background: var(--surface);
  box-shadow: var(--shadow-strong);
  display: grid;
  grid-template-rows: auto minmax(0, 1fr);
  animation: fadeUp 240ms var(--ease-out) both;
}

.overlay-head {
  padding: 13px 16px;
  border-bottom: 1px solid var(--line);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  background: rgba(253, 250, 245, 0.96);
}

.overlay-head-left {
  display: grid;
  gap: 2px;
}

.overlay-body {
  padding: 14px;
  overflow: auto;
}

/* Momentum preview */
.momentum-preview { display: grid; gap: 10px; }
.momentum-preview-meta { margin: 0; font-size: 0.76rem; color: var(--muted); }
.momentum-preview-title { margin: 0; color: var(--text); font-size: 1.02rem; }
.momentum-preview-image,
.momentum-preview-media {
  width: 100%;
  max-height: min(72vh, 760px);
  border-radius: var(--r-md);
  border: 1px solid var(--line);
  background: #1a1512;
}
.momentum-preview-image { object-fit: contain; background: var(--bg); }
.momentum-preview-embed {
  width: 100%;
  aspect-ratio: 16 / 9;
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background: #1a1512;
}
.momentum-preview-actions { margin-top: 4px; }

/* ────────────────────────────────────────────────────────────────
   16. Forms & Inputs
   ──────────────────────────────────────────────────────────────── */
#search-input,
#note-title,
#note-tags,
#source-urls,
#tutor-question,
#referral-code-input,
#profile-display-name,
#password-current,
#password-new,
#delete-account-confirm,
#delete-account-password,
#plan-days,
#plan-minutes,
#reminder-time,
#exam-mode,
#theme-select,
#auth-email,
#auth-password,
#onboarding-email {
  width: 100%;
  border: 1px solid var(--line-strong);
  border-radius: var(--r-sm);
  padding: 9px 11px;
  font: 500 0.91rem "DM Sans", sans-serif;
  background: rgba(255, 254, 250, 0.92);
  color: var(--text);
  transition: border-color var(--dur-fast) ease, box-shadow var(--dur-fast) ease;
}

#feedback-text,
#profile-bio {
  width: 100%;
  border: 1px solid var(--line-strong);
  border-radius: var(--r-sm);
  padding: 9px 11px;
  font: 500 0.89rem "DM Sans", sans-serif;
  background: rgba(255, 254, 250, 0.92);
  color: var(--text);
  transition: border-color var(--dur-fast) ease, box-shadow var(--dur-fast) ease;
}

#search-input:focus,
#note-title:focus,
#note-tags:focus,
#source-urls:focus,
#tutor-question:focus,
#referral-code-input:focus,
#profile-display-name:focus,
#password-current:focus,
#password-new:focus,
#delete-account-confirm:focus,
#delete-account-password:focus,
#plan-days:focus,
#plan-minutes:focus,
#reminder-time:focus,
#exam-mode:focus,
#theme-select:focus,
#auth-email:focus,
#auth-password:focus,
#feedback-text:focus,
#profile-bio:focus,
#onboarding-email:focus {
  outline: 2px solid var(--ring);
  outline-offset: 1px;
  border-color: rgba(91, 33, 182, 0.42);
}

/* ────────────────────────────────────────────────────────────────
   17. Buttons & CTAs
   ──────────────────────────────────────────────────────────────── */
button {
  border: 1px solid var(--accent-mid);
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent-mid) 100%);
  color: #f5f3ff;
  border-radius: var(--r-sm);
  padding: 8px 14px;
  font: 600 0.88rem "DM Sans", sans-serif;
  cursor: pointer;
  transition:
    filter var(--dur-fast) ease,
    transform var(--dur-fast) var(--ease-out),
    box-shadow var(--dur-fast) ease;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

button:hover {
  filter: brightness(1.08);
  transform: translateY(-1px);
  box-shadow: 0 4px 14px rgba(91, 33, 182, 0.30);
}

button:active {
  transform: translateY(0);
  filter: brightness(0.97);
}

button:disabled {
  cursor: not-allowed;
  opacity: 0.52;
  transform: none;
  box-shadow: none;
}

button.ghost {
  border-color: var(--line-strong);
  background: rgba(255, 254, 250, 0.82);
  color: #4a3e32;
  box-shadow: none;
}

button.ghost:hover {
  filter: none;
  background: rgba(237, 233, 254, 0.70);
  border-color: rgba(91, 33, 182, 0.32);
  color: var(--accent-hover);
  box-shadow: none;
}

button.danger {
  border-color: rgba(185, 28, 28, 0.32);
  background: rgba(254, 226, 226, 0.80);
  color: #991b1b;
}

button.danger:hover {
  filter: none;
  background: rgba(254, 202, 202, 0.90);
  box-shadow: 0 3px 12px rgba(185, 28, 28, 0.18);
}

/* CTA links */
a.cta-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  text-decoration: none;
  border: 1px solid var(--accent-mid);
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent-mid) 100%);
  color: #f5f3ff;
  border-radius: var(--r-sm);
  padding: 9px 16px;
  font: 600 0.88rem "DM Sans", sans-serif;
  transition: filter var(--dur-fast) ease, transform var(--dur-fast) var(--ease-out);
}

a.cta-btn:hover {
  filter: brightness(1.08);
  transform: translateY(-1px);
}

a.cta-btn.ghost {
  border-color: var(--line-strong);
  background: rgba(255, 254, 250, 0.82);
  color: #4a3e32;
}

a.cta-btn.ghost:hover {
  filter: none;
  background: var(--accent-soft);
  border-color: rgba(91, 33, 182, 0.30);
  color: var(--accent-hover);
}

/* ────────────────────────────────────────────────────────────────
   18. Status, Badge, Divider, Row helpers
   ──────────────────────────────────────────────────────────────── */
.status {
  min-height: 1.2rem;
  color: var(--text);
  font-size: 0.84rem;
  white-space: pre-wrap;
}

.badge {
  border-radius: var(--r-pill);
  border: 1px solid rgba(91, 33, 182, 0.28);
  background: var(--accent-soft);
  color: var(--accent);
  font: 600 0.70rem/1 "JetBrains Mono", monospace;
  letter-spacing: 0.05em;
  padding: 4px 9px;
}

.muted {
  color: var(--muted);
  font-size: 0.92rem;
}

.divider {
  height: 1px;
  background: var(--line);
  margin: 8px 0;
}

.row {
  display: flex;
  gap: 8px;
}

.wrap {
  flex-wrap: wrap;
}

.mono {
  font-family: "JetBrains Mono", monospace;
  white-space: pre-wrap;
}

.grid-two {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 10px;
}

/* ────────────────────────────────────────────────────────────────
   19. AI Output & Editor
   ──────────────────────────────────────────────────────────────── */
.ai-output {
  min-height: 5rem;
  border: 1px dashed var(--line-strong);
  border-radius: var(--r-md);
  background: rgba(253, 250, 245, 0.80);
  padding: 10px;
  white-space: pre-wrap;
  font: 400 0.85rem/1.48 "JetBrains Mono", monospace;
  color: var(--text);
}

/* ────────────────────────────────────────────────────────────────
   20. Upload / Drop Zones
   ──────────────────────────────────────────────────────────────── */
.upload-selection {
  margin-top: 5px;
  font-size: 0.83rem;
}

.upload-drop-zone {
  margin-top: 6px;
  border: 1.5px dashed var(--line-strong);
  border-radius: var(--r-md);
  background: rgba(250, 247, 241, 0.78);
  color: var(--muted);
  padding: 11px 14px;
  font: 500 0.84rem/1.35 "DM Sans", sans-serif;
  text-align: center;
  cursor: pointer;
  user-select: none;
  transition: border-color var(--dur-fast) ease, background var(--dur-fast) ease;
}

.upload-drop-zone.compact {
  width: 100%;
  margin-top: 0;
}

.upload-drop-zone.drag-active {
  border-color: var(--accent);
  background: var(--accent-soft);
  color: var(--accent);
  box-shadow: 0 0 0 3px rgba(91, 33, 182, 0.14);
}

.upload-drop-zone:focus-visible {
  outline: 2px solid var(--ring);
  outline-offset: 2px;
}

/* ────────────────────────────────────────────────────────────────
   21. Flashcard Float (draggable overlay)
   ──────────────────────────────────────────────────────────────── */
.flashcard-stage {
  position: relative;
  min-height: 60vh;
}

.flashcard-float {
  position: absolute;
  left: 24px;
  top: 16px;
  width: min(760px, calc(100% - 48px));
  max-width: calc(100% - 48px);
  border-radius: var(--r-lg);
  border: 1px solid var(--line);
  background: var(--card-solid);
  box-shadow: var(--shadow-strong);
  overflow: hidden;
  --fc-scale: 1;
}

.flashcard-float-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 9px 12px;
  border-bottom: 1px solid var(--line);
  cursor: move;
  user-select: none;
  touch-action: none;
  background: rgba(250, 247, 241, 0.95);
}

.flashcard-float-body {
  padding: 13px;
}

.flashcard-float .mono {
  font-size: calc(0.86rem * var(--fc-scale));
  line-height: 1.55;
}

.fc-resizer {
  position: absolute;
  right: 10px;
  bottom: 10px;
  width: 18px;
  height: 18px;
  border-radius: 5px;
  border: 1px solid var(--line-strong);
  background: var(--card-solid);
  cursor: nwse-resize;
  touch-action: none;
}

.fc-resizer::before {
  content: "";
  position: absolute;
  inset: 4px;
  border-right: 2px solid var(--muted);
  border-bottom: 2px solid var(--muted);
  border-radius: 2px;
}

/* ────────────────────────────────────────────────────────────────
   22. Ad Slots (functional – visual only)
   ──────────────────────────────────────────────────────────────── */
.ad-bottom {
  position: fixed;
  left: 0; right: 0; bottom: 0;
  z-index: 70;
  padding: 10px;
  border-top: 1px solid var(--line);
  background: rgba(253, 250, 245, 0.96);
  backdrop-filter: blur(12px);
}

.ad-bottom.hidden { display: none; }

.ad-inner {
  width: min(1200px, calc(100vw - 20px));
  margin: 0 auto;
  display: grid;
  gap: 10px;
  grid-template-columns: 90px 1fr;
  align-items: center;
}

.ad-label {
  font: 600 0.68rem/1 "JetBrains Mono", monospace;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--muted);
}

.ad-slot {
  min-height: 62px;
  border: 1px dashed var(--line-strong);
  border-radius: var(--r-sm);
  background: rgba(255, 255, 255, 0.70);
  overflow: hidden;
}

.ad-slot .adsbygoogle {
  display: block !important;
  width: 100% !important;
  height: 90px !important;
  max-height: 90px !important;
  overflow: hidden !important;
}

.ad-slot.ad-empty {
  min-height: 0;
  max-height: 0;
  border: 0;
  margin: 0;
  padding: 0;
}

.ad-bottom.ad-empty { display: none; }

.output-ads-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 10px;
}

.output-ads-actions {
  margin-top: 10px;
  justify-content: flex-end;
}

/* ────────────────────────────────────────────────────────────────
   23. Legal Links (fixed footer badge)
   ──────────────────────────────────────────────────────────────── */
.legal-links {
  position: fixed;
  right: 14px;
  bottom: 14px;
  z-index: 71;
  display: flex;
  gap: 10px;
  border: 1px solid var(--line);
  border-radius: var(--r-pill);
  background: rgba(253, 250, 245, 0.92);
  padding: 5px 10px;
  backdrop-filter: blur(10px);
  box-shadow: var(--shadow-card);
}

.legal-links a {
  color: var(--muted);
  text-decoration: none;
  font: 600 0.75rem "DM Sans", sans-serif;
}

.legal-links a:hover {
  color: var(--accent);
  text-decoration: underline;
}

/* ────────────────────────────────────────────────────────────────
   24. Tutorial & Onboarding
   ──────────────────────────────────────────────────────────────── */
.tutorial-focus {
  position: relative;
  z-index: 90 !important;
  outline: 3px solid rgba(91, 33, 182, 0.80);
  outline-offset: 3px;
  border-radius: var(--r-md);
  box-shadow: 0 0 0 8px rgba(91, 33, 182, 0.16);
}

.tips-list {
  margin: 8px 0 0;
  padding-left: 18px;
  font-size: 0.85rem;
  color: var(--text);
}

/* ────────────────────────────────────────────────────────────────
   25. Autofill Decoy (anti-password-manager hack)
   ──────────────────────────────────────────────────────────────── */
.autofill-decoy {
  position: absolute;
  left: -10000px;
  top: auto;
  width: 1px;
  height: 1px;
  opacity: 0;
  overflow: hidden;
  pointer-events: none;
}

.autofill-decoy input {
  width: 1px;
  height: 1px;
  border: 0;
  padding: 0;
}

/* ────────────────────────────────────────────────────────────────
   26. Welcome Page
   ──────────────────────────────────────────────────────────────── */
.welcome-page {
  padding: 14px 14px 24px;
}

.modern-surface-page {
  min-height: 100vh;
}

.welcome-shell {
  position: relative;
  z-index: 2;
  width: min(1180px, 100%);
  margin: 0 auto;
  display: grid;
  gap: 14px;
}

.welcome-brand-head {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 10px;
}

.welcome-brand-card {
  background: rgba(255, 254, 250, 0.82);
  backdrop-filter: blur(10px);
}

.welcome-brand-logo {
  width: min(500px, 92%);
  height: auto;
}

/* Hero */
.welcome-hero {
  display: grid;
  grid-template-columns: 1.2fr 1fr;
  gap: 14px;
  position: relative;
}

.welcome-hero-card {
  position: relative;
  overflow: hidden;
}

.welcome-hero-deco {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.welcome-hero-deco svg {
  width: 100%;
  height: 100%;
  position: absolute;
  inset: 0;
}

.welcome-copy {
  display: flex;
  flex-direction: column;
  min-width: 0;
  gap: 10px;
  position: relative;
  z-index: 1;
}

.welcome-badge-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.welcome-copy h1 {
  margin: 0;
  font: 800 2.4rem/1.12 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
  letter-spacing: 0.01em;
}

.welcome-hero-media {
  display: grid;
  gap: 10px;
  position: relative;
  z-index: 1;
}

.welcome-photo {
  margin: 0;
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  background: var(--bg-b);
  overflow: hidden;
  display: grid;
}

.welcome-hero-media img {
  width: 100%;
  border-radius: 0;
  border: 0;
  object-fit: cover;
  background: var(--bg-b);
  min-height: 190px;
}

.welcome-video-inline {
  display: block;
  margin-top: 4px;
}

.welcome-video-frame {
  position: relative;
  border: 1px solid var(--line);
  border-radius: var(--r-lg);
  overflow: hidden;
  background: #1a1512;
}

.welcome-demo-video {
  display: block;
  width: 100%;
  aspect-ratio: 16 / 9;
  border-radius: 0;
  border: 0;
  background: #1a1512;
  object-fit: cover;
}

.welcome-video-menu {
  position: absolute;
  right: 10px;
  bottom: 10px;
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  padding: 8px;
  border: 1px solid var(--line);
  border-radius: var(--r-md);
  background: rgba(255, 254, 250, 0.94);
  backdrop-filter: blur(6px);
  z-index: 3;
  box-shadow: var(--shadow);
}

/* Info cards grid */
.welcome-info-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 12px;
}

.welcome-info-card {
  display: grid;
  gap: 8px;
}

.welcome-info-card img {
  width: 100%;
  height: 165px;
  object-fit: cover;
  border-radius: var(--r-md);
  border: 1px solid var(--line);
}

.welcome-info-card h3 { margin: 0; }

.welcome-feature-card {
  transition: transform var(--dur-base) var(--ease-out), box-shadow var(--dur-base) ease;
}

.welcome-feature-card:hover {
  transform: translateY(-3px);
  box-shadow: var(--shadow-strong);
}

.feature-icon-wrap {
  width: 40px;
  height: 40px;
  border-radius: var(--r-md);
  border: 1px solid rgba(91, 33, 182, 0.26);
  background: var(--accent-soft);
  display: grid;
  place-items: center;
  padding: 8px;
}

.feature-icon-wrap svg {
  width: 100%;
  height: 100%;
  stroke: var(--accent);
  stroke-width: 1.8;
  fill: none;
  stroke-linecap: round;
  stroke-linejoin: round;
}

.welcome-site-info h3 { margin: 0 0 8px; }

.welcome-list {
  margin: 0;
  padding-left: 18px;
  display: grid;
  gap: 6px;
  color: var(--text);
  font-size: 0.93rem;
}

/* ────────────────────────────────────────────────────────────────
   27. Login Page
   ──────────────────────────────────────────────────────────────── */
.login-page {
  padding: 16px;
}

.login-wrap {
  width: min(700px, 100%);
  margin: 6vh auto 0;
}

.login-wrap-modern {
  width: min(760px, 100%);
}

.login-card {
  display: grid;
  gap: 0;
}

.login-card-modern {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
  overflow: hidden;
  border-radius: var(--r-xl);
  border: 1px solid var(--line);
  background: var(--card);
  box-shadow: var(--shadow-strong);
  padding: 0;
}

.login-main {
  padding: 28px 26px;
  display: grid;
  gap: 12px;
  align-content: start;
}

.login-main h1 {
  font: 700 1.65rem/1.2 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
  margin: 0;
}

.login-aside {
  background:
    radial-gradient(circle at 80% 20%, rgba(91, 33, 182, 0.14), transparent 55%),
    linear-gradient(165deg, rgba(237, 233, 254, 0.82), rgba(248, 244, 236, 0.60));
  border-left: 1px solid var(--line);
  padding: 28px 22px;
  display: grid;
  gap: 12px;
  align-content: start;
}

.login-aside-deco {
  margin-bottom: 4px;
}

.login-aside h3 {
  margin: 0;
  font: 700 1.1rem/1.25 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
}

.login-aside-image {
  width: 100%;
  height: 160px;
  object-fit: cover;
  border-radius: var(--r-md);
  border: 1px solid var(--line);
}

.login-benefits {
  font-size: 0.88rem;
}

.login-brand-logo {
  width: min(260px, 100%);
  height: auto;
  display: block;
}

.auth-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
}

/* Brand home link (shared) */
.brand-home-link {
  display: inline-flex;
  align-items: center;
}

/* ────────────────────────────────────────────────────────────────
   28. Doc / Legal / Share Pages
   ──────────────────────────────────────────────────────────────── */
.doc-page {
  padding: 20px 16px 32px;
}

.doc-shell {
  position: relative;
  z-index: 2;
  width: min(820px, 100%);
  margin: 0 auto;
  display: grid;
  gap: 16px;
  animation: fadeUp var(--dur-slow) var(--ease-out) both;
}

.share-shell {
  width: min(900px, 100%);
}

.doc-hero {
  position: relative;
  overflow: hidden;
}

.doc-hero h1 {
  font: 700 2rem/1.18 "Fraunces", "DM Sans", sans-serif;
  color: var(--text);
  margin: 6px 0 4px;
}

.doc-card {
  line-height: 1.72;
}

.doc-card p {
  margin: 0 0 12px;
  color: var(--text);
}

.doc-card ul {
  margin: 0 0 12px;
  padding-left: 20px;
  color: var(--text);
}

.doc-card li {
  margin-bottom: 6px;
}

.legal-brand-logo {
  width: min(260px, 100%);
  height: auto;
  display: block;
  margin-bottom: 12px;
}

/* Share page content */
.share-content {
  min-height: 12rem;
  font-size: 0.96rem;
  line-height: 1.7;
}

/* ────────────────────────────────────────────────────────────────
   29. Focus Mode
   ──────────────────────────────────────────────────────────────── */
body.focus-mode[data-app-view="notes"] .left-rail {
  display: none;
}

body.focus-mode[data-app-view="notes"] .app-shell {
  grid-template-columns: 1fr;
}

body.focus-mode[data-app-view="notes"] .workspace {
  grid-template-columns: 1fr;
}

/* ────────────────────────────────────────────────────────────────
   30. Utility
   ──────────────────────────────────────────────────────────────── */
.hidden {
  display: none !important;
}

/* ────────────────────────────────────────────────────────────────
   31. Animations
   ──────────────────────────────────────────────────────────────── */
@keyframes fadeUp {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes floatA {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33%       { transform: translate(2%, 3%) scale(1.02); }
  66%       { transform: translate(-1%, -2%) scale(0.98); }
}

@keyframes floatB {
  0%, 100% { transform: translate(0, 0) scale(1); }
  40%       { transform: translate(-2%, 2%) scale(1.02); }
  70%       { transform: translate(1%, -2%) scale(0.99); }
}

/* ────────────────────────────────────────────────────────────────
   32. Responsive
   ──────────────────────────────────────────────────────────────── */

/* Large tablets / small desktops */
@media (max-width: 1260px) {
  .learning-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .home-metrics-grid {
    grid-template-columns: repeat(3, minmax(0, 1fr));
  }
}

@media (max-width: 1220px) {
  .home-orbit-grid {
    grid-template-columns: 1fr;
  }

  .sources-stack,
  #view-study-tools .study-lab-stack {
    grid-template-columns: 1fr;
    grid-template-areas: none;
  }

  .source-import-card,
  .source-list-card,
  #view-study-tools .study-hub-card,
  #view-study-tools .study-tutor-card,
  #view-study-tools .study-plan-card,
  #view-study-tools .study-learning-card {
    grid-area: unset;
  }
}

/* Tablet / narrow */
@media (max-width: 1020px) {
  .app-shell {
    grid-template-columns: 1fr;
    border-radius: var(--r-xl);
  }

  .left-rail {
    grid-template-rows: auto;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 10px;
    padding: 12px 14px;
    border-right: 0;
    border-bottom: 1px solid var(--line);
  }

  .rail-brand { justify-items: start; }
  .rail-brand-logo { width: 148px; }
  .rail-kicker { display: none; }

  .rail-nav {
    display: flex;
    gap: 6px;
    overflow: auto;
    scrollbar-width: none;
  }

  .rail-nav-item {
    white-space: nowrap;
    min-width: max-content;
  }

  .rail-bottom {
    border-top: 0;
    padding-top: 0;
  }

  .workspace,
  .notebook-workspace {
    grid-template-columns: 1fr;
    min-height: auto;
  }

  .workspace .panel.left {
    max-height: 38vh;
  }

  .metrics-grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }

  .welcome-hero {
    grid-template-columns: 1fr;
  }

  .welcome-info-grid {
    grid-template-columns: 1fr;
  }

  .view-hero {
    grid-template-columns: 1fr;
    align-items: start;
  }

  .view-hero-pills {
    justify-content: flex-start;
  }

  .login-card-modern {
    grid-template-columns: 1fr;
  }

  .login-aside {
    border-left: 0;
    border-top: 1px solid var(--line);
  }

  .account-profile-wrap {
    grid-template-columns: 1fr;
  }

  .account-avatar-wrap {
    justify-items: start;
  }
}

/* Mobile */
@media (max-width: 760px) {
  .route-canvas { padding: 10px; }
  .top-bar { padding: 10px 12px; }
  .top-brand-logo { width: 120px; }
  .top-head-copy { display: none; }

  .home-title { font-size: 1.55rem; }
  .home-metrics-grid { grid-template-columns: 1fr; }

  .home-composer {
    grid-template-columns: 1fr;
  }

  .home-composer-actions {
    justify-content: flex-start;
    flex-wrap: wrap;
  }

  .learning-grid { grid-template-columns: 1fr; }

  .output-ads-grid { grid-template-columns: 1fr; }

  .grid-two,
  .metrics-grid.two-col {
    grid-template-columns: 1fr;
  }

  .legal-links {
    left: 10px;
    right: 10px;
    bottom: 10px;
    justify-content: center;
  }

  .note-editor { min-height: 36vh; }

  .view-hero {
    padding: 13px;
    border-radius: var(--r-lg);
  }

  .view-hero-copy h2 { font-size: 1.3rem; }
  .view-hero-copy p  { font-size: 0.91rem; }

  .welcome-copy h1 { font-size: 1.9rem; }

  .doc-hero h1 { font-size: 1.5rem; }

  .account-avatar-preview {
    width: 104px;
    height: 104px;
  }
}
